/////////////////////////////////////////////////////////////////// Algorithm reading the Irene Events and filling Alex Classes:// AHits, AParticles and ATTracks.// Persistency is made by ASvc./////////////////////////////////////////////////////////////////#include "IreneLoader.hh"#include <alex/ISvc.h>#include <alex/PSvc.h>#include <alex/ASvc.h>#include <alex/ATTrack.h>#include <alex/AParticle.h>#include <alex/AHit.h>#include <alex/VectorOperations.h>namespace alex {  //--------------------------------------------------------------------  bool IreneLoader::Init()  //--------------------------------------------------------------------  {    // Set the Debug Level    SetDebugLevel("INFO");    log4cpp::Category& klog = log4cpp::Category::getRoot();    klog << log4cpp::Priority::INFO << "IreneLoader::Init()" ;    return true;  }    //--------------------------------------------------------------------  bool IreneLoader::Execute()  //--------------------------------------------------------------------  {    log4cpp::Category& klog = log4cpp::Category::getRoot();    klog << log4cpp::Priority::DEBUG << "IreneLoader::Execute()";    // Getting Irene Tracks    std::vector<const irene::Track*> iTracks;    iTracks = ISvc::Instance().GetEvent().Tracks();    // Clear Alex Service    ASvc::Instance().Clear();    // ATTrack    for (int t=0; t<iTracks.size(); t++) {      const irene::Track* iTrack = iTracks.at(t);      const irene::Particle* iPart = iTrack->GetParticle();      ATTrack* track = new ATTrack();      int id = iPart->GetParticleID();      track->SetID(id);      track->SetParticleID(id);      // AHits      const std::vector<std::pair<TLorentzVector,double> >& iHits = iTrack->GetHits();      for (int h=0; h<iHits.size(); h++) {      	const std::pair<TLorentzVector,double> iHit = iHits[h];      	AHit* aHit = new AHit();      	aHit->SetID(h);      	aHit->SetPosition(iHit.first.Vect());      	aHit->SetEdep(iHit.second);      	track->AddHit(aHit);        if (h==0) track->SetExtreme1(aHit);        if (h==iHits.size()-1) track->SetExtreme2(aHit);              	delete aHit;      }      // AParticle	    AParticle* aPart = new AParticle();      aPart->SetID(iPart->GetParticleID());      aPart->SetName(iPart->Name());      aPart->SetCharge(iPart->GetCharge());      aPart->SetVertex(iPart->GetInitialVertex().Vect());      aPart->SetP4(iPart->GetInitialMomentum());      aPart->SetIsPrimary(iPart->IsPrimary());      aPart->SetMotherID(0);      if (!aPart->GetIsPrimary())        aPart->SetMotherID(iPart->GetMother()->GetParticleID());      aPart->SetProperty("CreatorProcess", iPart->GetCreatorProcess());      aPart->SetProperty("TrackLength", std::to_string(iPart->GetTrackLength()));      // Persistency      ASvc::Instance().AddParticle(aPart);      ASvc::Instance().AddTTrack(track);      //klog << log4cpp::Priority::DEBUG << track->PrintInfo();      //klog << log4cpp::Priority::DEBUG << aPart->PrintInfo();      delete aPart;      delete track;          }    int numParts   = ASvc::Instance().GetParticles().size();    int numTTracks = ASvc::Instance().GetTTracks().size();    fIreneLoader_NumParts_H1->Fill(numParts);    fIreneLoader_NumTTracks_H1->Fill(numTTracks);    klog << log4cpp::Priority::DEBUG << "IreneLoader::Num Particles: " << numParts;    klog << log4cpp::Priority::DEBUG << "IreneLoader::Num TTracks: " << numTTracks;    return true;  }    //--------------------------------------------------------------------  bool IreneLoader::End()  //--------------------------------------------------------------------  {    log4cpp::Category& klog = log4cpp::Category::getRoot();    klog << log4cpp::Priority::INFO << "IreneLoader::End()";    return true;  }}